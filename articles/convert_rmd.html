<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>convert_rmd • govspeakr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="convert_rmd">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">govspeakr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/callout_box.html">callout_box</a></li>
    <li><a class="dropdown-item" href="../articles/conditional_output.html">conditional_output</a></li>
    <li><a class="dropdown-item" href="../articles/convert_rmd.html">convert_rmd</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>convert_rmd</h1>
            
      

      <div class="d-none name"><code>convert_rmd.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://department-for-transport-public.github.io/mojspeakr/">govspeakr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-principle-behind-converting-rmarkdown-to-govspeak">The principle behind converting RMarkdown to govspeak<a class="anchor" aria-label="anchor" href="#the-principle-behind-converting-rmarkdown-to-govspeak"></a>
</h2>
<div class="section level3">
<h3 id="what-is-govspeak">What is govspeak?<a class="anchor" aria-label="anchor" href="#what-is-govspeak"></a>
</h3>
<p>Govspeak is a coding language, very similar to markdown itself, which
is used to create content for gov.uk through a platform known as
Whitehall publisher. If you release content in “HTML” format on gov.uk,
you will actually write that content in the govspeak language, and on
publishing it will be converted to HTML. For people wanting to create a
govspeak output from an Rmarkdown file, the {govspeakr} package aims to
make it easy to generate that output.</p>
</div>
<div class="section level3">
<h3 id="how-rmarkdown-works">How RMarkdown works<a class="anchor" aria-label="anchor" href="#how-rmarkdown-works"></a>
</h3>
<p>It’s useful to understand how RMarkdown works under the hood to help
you understand how to produce govspeak outputs.</p>
<p>RMarkdown is a file format that allows you to write text and code
together. When you knit an RMarkdown file, the code is run and the
output is inserted into the document. The output can be in a variety of
formats, such as HTML, PDF, or Word.</p>
<p>When you knit RMarkdown, the first thing the file does is generate
intermediate content: a markdown file (.md) made up of raw markdown
content, and image files for any charts, images, etc. These files are
then combined to produce the final output, and the intermediate files
are deleted. The markdown used in that intermediate .md file is
virtually identical to the markdown used in govspeak, with a few
exceptions.</p>
</div>
</div>
<div class="section level2">
<h2 id="setting-up-your-rmarkdown-file-to-use-govspeakr">Setting up your RMarkdown file to use {govspeakr}<a class="anchor" aria-label="anchor" href="#setting-up-your-rmarkdown-file-to-use-govspeakr"></a>
</h2>
<p>{govspeakr} is designed to be used alongside an RMarkdown file,
acting directly on the intermediate .md file, and cannot be called
inside the RMarkdown file itself.</p>
<p>To use the ability of govspeakr to convert to govspeak, there are a
few steps you need to follow when setting up your Rmarkdown file, all of
which take place in the YAML header.</p>
<div class="section level3">
<h3 id="what-is-the-yaml-header">What is the YAML header?<a class="anchor" aria-label="anchor" href="#what-is-the-yaml-header"></a>
</h3>
<p>The YAML header of an RMarkdown file is a section at the top of the
file that contains metadata about the document. This metadata includes
the title of the document, the author, the date, and the output format.
The YAML header is enclosed by three dashes at the top and bottom of the
section.</p>
</div>
<div class="section level3">
<h3 id="setting-up-the-yaml-header">Setting up the YAML header<a class="anchor" aria-label="anchor" href="#setting-up-the-yaml-header"></a>
</h3>
<p>To use {govspeakr} to convert your RMarkdown file to govspeak, you
need to set the <code>keep_md</code> argument to <code>true</code> in
the YAML header of the RMarkdown document. This tells RMarkdown to keep
the intermediate .md file after knitting, which is necessary for
{govspeakr} to work. It also keeps the intermediate .svg/.png images
created in the report, so you don’t need to save these separately.</p>
<p>Note that YAML is tab sensitive, so an example of using the
<code>keep_md</code> argument in the YAML header would look like
this:</p>
<pre><code>---
title: "My Rmarkdown File"
output: 
  html_document:
    keep_md: true
---</code></pre>
<p>Because we keep the intermediate .md file, this means that it can
often be hard or impossible to output both a nicely formatted version of
your publication <em>and</em> the intermediate markdown from the same
output. Many people therefore choose to carry out dual ouput; that is,
to output both a nicely formatted version of the publication and the
intermediate markdown from the same Rmarkdown. This can be achieved by
setting up the YAML header as follows:</p>
<pre><code>---
title: "My Rmarkdown File"
output: 
  html_document:
    keep_md: true
  word_document:
    #any other parameters relevant to the word document here
---</code></pre>
<p>You can choose which format you want to have as your “nice” version,
and which you want to be associated with the intermediate markdown file.
It is getting more common for people to choose to output a nice HTML
version of the publication, and to keep the intermediate markdown file
associated with the word output, allowing your HTML output to look very
similar to your final Whitehall publisher version. Setting up your YAML
to allow this would look like this:</p>
<pre><code>---
title: "My Rmarkdown File"
output: 
  word_document:
    keep_md: true
  html_document:
    #any other parameters relevant to the html document here
---</code></pre>
<p>Note that the title, date, author etc are set inside Whitehall and
<em>not</em> by your YAML header, so you don’t need to worry about this
looking neat and tidy.</p>
</div>
</div>
<div class="section level2">
<h2 id="rendering-multiple-outputs">Rendering multiple outputs<a class="anchor" aria-label="anchor" href="#rendering-multiple-outputs"></a>
</h2>
<p>For RMarkdown documents where you have multiple output formats listed
in the YAML header, pressing knit will only render the first output
format listed. To render both output formats, you will need to use the
<code><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">rmarkdown::render()</a></code> function with the argument
<code>outputs = "all"</code>. This will render all output formats listed
in the YAML header, in the order they are listed in the YAML. The
<code>render()</code> function should be called inside a separate script
file, and not inside the RMarkdown file itself.</p>
<p>An example of how to use the <code>render()</code> function to render
all output formats listed in the YAML header would look like this:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html" class="external-link">render</a></span><span class="op">(</span><span class="st">"path/to/your/RMarkdown/file.Rmd"</span>, output_format <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="converting-the--md-file-to-govspeak">Converting the .md file to govspeak<a class="anchor" aria-label="anchor" href="#converting-the--md-file-to-govspeak"></a>
</h2>
<p>Once you have set up your RMarkdown file to keep the intermediate .md
file, you can convert this .md file to govspeak using the
<code><a href="../reference/convert_rmd.html">convert_rmd()</a></code> function from the {govspeakr} package. This
function takes the path to the .md file as an argument, and returns the
govspeak version of the file as a file called
<code>original_file_name_converted.md</code>.</p>
<p>The conversion steps carried out when using the
<code><a href="../reference/convert_rmd.html">convert_rmd()</a></code> function are as follows:</p>
<ul>
<li>Image tags are converted from standard markdown to govspeak
i.e.</li>
</ul>
<pre><code>Figure 1
![](images/image1.png)&lt;!-- --&gt;!

Figure 1
[Image:image1.png]</code></pre>
<p>The function produces a message to let you know how many image
references it has found and converted. If there are no images found,
this is fine, the function will still run.</p>
<ul>
<li><p>Page breaks are replaced. This feature can be controlled using
the “page_break” argument. <code>page_break = "line"</code> replaces
them with a horizontal ruling, while <code>page_break = "none"</code>
just moves the subsequent text onto a new line, and
<code>page_break = "unchanged"</code> makes no replacement.</p></li>
<li><p>The YAML header is removed, as are any code chunks you have set
to echo = TRUE. You will be warned if more than one YAML header is
found, or if any code chunks are found.</p></li>
<li><p>As GOV.UK cannot accept first-level headers (single #), all
hashed headers are increased by one level i.e. <code># Title</code>
becomes <code>## Title</code>. This functionality can be controlled
using the sub_pattern argument. Setting it to TRUE increases all headers
by one level. FALSE results in no changes to the headers as written.
Passing the argument a vector allows selective changing of specific
headers, e.g. <code>sub_pattern = c("#", "##")</code> would change only
first and second level headers.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Francesca.Bryden.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
